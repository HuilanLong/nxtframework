(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15c56b2a"],{"1aa6":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-card",{staticStyle:{"margin-top":"10px"}},[n("el-form",{attrs:{"label-position":"top","label-width":"80px",model:e.formLabelAlign}},[n("el-form-item",{attrs:{label:"标题"}},[n("el-input",{model:{value:e.formLabelAlign.product_name,callback:function(t){e.$set(e.formLabelAlign,"product_name",t)},expression:"formLabelAlign.product_name"}})],1),e._v(" "),n("el-form-item",[n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formLabelAlign.category_id,callback:function(t){e.$set(e.formLabelAlign,"category_id",t)},expression:"formLabelAlign.category_id"}},e._l(e.category_list,(function(e){return n("el-option",{key:e.category_id,attrs:{label:e.category_name_display,value:e.category_id}})})),1),e._v(" "),n("router-link",{attrs:{to:"/product/kind"}},[n("el-button",[e._v("类别管理")])],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"副标题（营销性文字）"}},[n("el-input",{model:{value:e.formLabelAlign.product_subtitle,callback:function(t){e.$set(e.formLabelAlign,"product_subtitle",t)},expression:"formLabelAlign.product_subtitle"}})],1),e._v(" "),n("el-card",{staticStyle:{"margin-bottom":"10px"},attrs:{shadow:"never"}},[n("el-form-item",[e._v("\n          价格\n          "),n("el-input",{staticStyle:{width:"220px"},model:{value:e.formLabelAlign.price,callback:function(t){e.$set(e.formLabelAlign,"price",t)},expression:"formLabelAlign.price"}}),e._v(" "),n("el-checkbox",{model:{value:e.price_negotiation,callback:function(t){e.price_negotiation=t},expression:"price_negotiation"}},[e._v("是否面议")])],1),e._v(" "),n("el-form-item",[e._v("\n          价格说明\n          "),n("el-input",{staticStyle:{width:"500px"},model:{value:e.formLabelAlign.price_remark,callback:function(t){e.$set(e.formLabelAlign,"price_remark",t)},expression:"formLabelAlign.price_remark"}})],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"产品属性"}},[n("el-card",{attrs:{shadow:"never"}},[e._l(e.formLabelAlign.product_sku,(function(t,i){return n("el-form-item",{key:i,attrs:{label:t.name}},[e._l(t.sku,(function(i,r){return n("el-tag",{key:r,attrs:{closable:"","disable-transitions":!1},on:{close:function(n){return e.handleColorClose(t.name,i)}}},[e._v("\n              "+e._s(i)+"\n            ")])})),e._v(" "),n("el-input",{ref:"saveColorTagInput",refInFor:!0,staticClass:"input-new-tag",attrs:{size:"small"},model:{value:t[i],callback:function(n){e.$set(t,i,n)},expression:"item[index]"}}),e._v(" "),n("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(n){return e.handleConfirm(t.name,t[i])}}},[e._v("增加")])],2)})),e._v(" "),n("el-card",{attrs:{shadow:"never"}},[n("el-form-item",{attrs:{label:"属性名称"}},[e._l(e.attributeNameTags,(function(t,i){return n("el-tag",{key:i,attrs:{closable:"","disable-transitions":!1},on:{close:function(n){return e.handleAttributeNameClose(t)}}},[e._v("\n                "+e._s(t)+"\n              ")])})),e._v(" "),n("el-input",{ref:"saveAttributeNameTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:e.AttributeNameinputValue,callback:function(t){e.AttributeNameinputValue=t},expression:"AttributeNameinputValue"}}),e._v(" "),n("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showAttributeNameInput}},[e._v("添加属性")])],2)],1)],2)],1),e._v(" "),n("el-form-item",{attrs:{label:"产品图片"}},[n("div",{staticClass:"box"},[n("draggable",e._b({staticClass:"list-group",attrs:{tag:"ul"},on:{start:function(t){e.productForm.drag=!0},end:function(t){e.productForm.drag=!1}},model:{value:e.productForm.productPicList,callback:function(t){e.$set(e.productForm,"productPicList",t)},expression:"productForm.productPicList"}},"draggable",e.dragOptions,!1),e._l(e.productForm.productPicList,(function(t,i){return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.productForm.loadingapp,expression:"productForm.loadingapp"}],key:i,staticClass:"img-wrapper divBox",on:{mouseenter:function(t){return e.showDelBtn(i)},mouseleave:e.hiddenDelBtn}},[t?n("img",{staticClass:"imgSty",attrs:{src:t,width:"148",height:"148"}}):e._e(),e._v(" "),n("div",{class:{mask:i===e.productForm.currentDelBtn}}),e._v(" "),n("i",{directives:[{name:"show",rawName:"v-show",value:i===e.productForm.currentDelBtn,expression:"index===productForm.currentDelBtn"}],staticClass:"el-icon-delete delIcon",on:{click:function(n){return e.deleImg(t,i)}}})])})),0),e._v(" "),n("el-upload",{attrs:{"show-file-list":!1,action:"","list-type":"picture-card","http-request":e.handleUploadHttpRequest,"on-success":e.handlePictureSuccess}},[n("i",{staticClass:"el-icon-plus"})])],1)]),e._v(" "),n("el-form-item",{staticStyle:{"margin-bottom":"30px"}},[n("Tinymce",{ref:"editor",attrs:{height:400},model:{value:e.formLabelAlign.product_description,callback:function(t){e.$set(e.formLabelAlign,"product_description",t)},expression:"formLabelAlign.product_description"}})],1),e._v(" "),n("el-form-item",[n("el-upload",{staticClass:"pic upload-demo",attrs:{action:"/api/admin/upload/public_pic",headers:e.headers,"show-file-list":!1,"on-success":e.UploadOnSuccess,"before-upload":e.beforeAvatarUpload}},[n("el-button",[e._v("上传插入图片")])],1)],1),e._v(" "),n("el-form-item",[n("el-checkbox",{model:{value:e.formLabelAlign.is_recommend,callback:function(t){e.$set(e.formLabelAlign,"is_recommend",t)},expression:"formLabelAlign.is_recommend"}},[e._v("推荐")])],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("发布")])],1)],1)],1)],1)},r=[],a=(n("96cf"),n("3b8d")),o=(n("6b54"),n("7f7f"),n("ac6a"),n("db72")),c=n("8256"),l=n("c4c8"),s=n("2f62"),u=n("5f87"),d=n("1980"),p=n.n(d),m={components:{Tinymce:c["a"],draggable:p.a},data:function(){return{checked:!1,formLabelAlign:{product_name:"",product_description:"",category_id:"",is_recommend:!1,product_picture_list:[],product_subtitle:"",price:"",price_negotiation:"0",price_remark:"",product_sku:[]},headers:{token:Object(u["a"])(),user_id:Object(u["b"])()},imageUrl:"",dialogVisible:!1,productForm:{productPicList:[],currentDelBtn:-1,loadingapp:!1,drag:!1,productObj:[]},colorTags:[],attributeNameTags:[],price_negotiation:!1,ColorinputVisible:!1,AttributeNameinputVisible:!1,ColorinputValue:"",AttributeNameinputValue:"",inputValue:""}},computed:Object(o["a"])(Object(o["a"])({},Object(s["c"])({category_list:function(e){return e.product.CategoryListData}})),{},{dragOptions:function(){return{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}}),created:function(){this.$store.dispatch("product/getCategory")},methods:{handleAvatarSuccess:function(e,t){this.imageUrl=URL.createObjectURL(t.raw)},beforeAvatarUpload:function(e){return!0},handleColorClose:function(e,t){this.formLabelAlign.product_sku.forEach((function(n){n.name!==e||n.sku.splice(n.sku.indexOf(t),1)}))},handleAttributeNameClose:function(e){this.attributeNameTags.splice(this.attributeNameTags.indexOf(e),1)},showAttributeNameInput:function(){var e=this;this.AttributeNameinputVisible=!0,this.$nextTick((function(t){e.$refs.saveAttributeNameTagInput.$refs.input.focus()}))},handleConfirm:function(e,t){console.log(e),t&&this.formLabelAlign.product_sku.forEach((function(n){n.name!==e||n.sku.push(t)}))},handleInputConfirm:function(){var e=this.AttributeNameinputValue;e&&this.formLabelAlign.product_sku.push({name:e,sku:[]}),this.AttributeNameinputVisible=!1,this.AttributeNameinputValue=""},handleCreate:function(){var e=this;this.formLabelAlign.is_recommend=this.formLabelAlign.is_recommend?1:0,this.formLabelAlign.product_picture_list=[],this.productForm.productPicList.forEach((function(t){e.productForm.productObj.forEach((function(n){t===n.url&&e.formLabelAlign.product_picture_list.push(n.id)}))}));var t=this,n=new FormData;n.append("category_id",this.formLabelAlign.category_id),n.append("product_name",this.formLabelAlign.product_name),n.append("product_description",this.formLabelAlign.product_description),n.append("is_recommend",this.formLabelAlign.is_recommend);var i="["+this.formLabelAlign.product_picture_list.toString()+"]";n.append("product_picture_list",i);for(var r="",a=0;a<this.formLabelAlign.product_sku.length;a++){var o=this.formLabelAlign.product_sku[a];r=a!==this.formLabelAlign.product_sku.length-1?r+'{"name":"'+o.name+'",sku:["'+o.sku.join('","')+'"]},':r+'{"name":"'+o.name+'",sku:["'+o.sku.join('","')+'"]}'}console.log(this.formLabelAlign.product_sku),console.log("["+r+"]"),n.append("product_sku","["+r+"]"),n.append("price",this.formLabelAlign.price),n.append("price_negotiation",this.price_negotiation?"1":"0"),n.append("price_remark",this.formLabelAlign.price_remark),n.append("product_subtitle",this.formLabelAlign.product_subtitle),this.$store.dispatch("product/createProduct",n).then((function(n){e.$message({message:"创建成功！",type:"success"}),t.$router.back()}))},handleUploadHttpRequest:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.file,i=new FormData,i.append("file",n),e.next=5,Object(l["m"])(i);case 5:r=e.sent,0===r.status?(this.$notify({title:"提示信息",message:"图片上传成功",type:"success",duration:2e3}),this.productForm.productPicList.push(r.url),this.productForm.productObj.push({id:r.id,url:r.url})):this.$notify({title:"提示信息",message:r.message,type:"error",duration:2e3});case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),UploadOnSuccess:function(e,t,n){this.$refs.editor.imageSuccessCBK([{url:e.url}]),this.$forceUpdate()},showDelBtn:function(e){this.productForm.currentDelBtn=e},hiddenDelBtn:function(){this.productForm.currentDelBtn=-1},deleImg:function(e,t){this.productForm.productPicList.splice(t,1)},handlePictureSuccess:function(e,t,n){var i="image/jpeg"===t.raw.type,r="image/jpg"===t.raw.type,a="image/png"===t.raw.type,o="image/gif"===t.raw.type;if(i||r||a||o){var c=this;new Promise((function(e,n){var i=window.URL||window.webkitURL,r=new Image;r.src=i.createObjectURL(t.raw)})).then((function(){return c.productForm.productPicList.push(t.response.data),t.raw}))}else this.$message.warning("只支持jpg或png或gif格式图片")}}},f=m,h=(n("e70b"),n("2877")),g=Object(h["a"])(f,i,r,!1,null,"849b1d92",null);t["default"]=g.exports},8256:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tinymce-container",class:{fullscreen:e.fullscreen},style:{width:e.containerWidth}},[n("textarea",{staticClass:"tinymce-textarea",attrs:{id:e.tinymceId}}),e._v(" "),n("div",{staticClass:"editor-custom-btn-container"})])},r=[],a=(n("ac6a"),n("c5f6"),["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"]),o=a,c=["searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],l=c,s=n("2d63"),u=[];function d(){return window.tinymce}var p=function(e,t){var n=document.getElementById(e),i=t||function(){};if(!n){var r=document.createElement("script");r.src=e,r.id=e,document.body.appendChild(r),u.push(i);var a="onload"in r?o:c;a(r)}function o(t){t.onload=function(){this.onerror=this.onload=null;var e,n=Object(s["a"])(u);try{for(n.s();!(e=n.n()).done;){var i=e.value;i(null,t)}}catch(r){n.e(r)}finally{n.f()}u=null},t.onerror=function(){this.onerror=this.onload=null,i(new Error("Failed to load "+e),t)}}function c(e){e.onreadystatechange=function(){if("complete"===this.readyState||"loaded"===this.readyState){this.onreadystatechange=null;var t,n=Object(s["a"])(u);try{for(n.s();!(t=n.n()).done;){var i=t.value;i(null,e)}}catch(r){n.e(r)}finally{n.f()}u=null}}}n&&i&&(d()?i(null,n):u.push(i))},m=p,f="https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js",h={name:"Tinymce",props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:[Number,String],required:!1,default:360},width:{type:[Number,String],required:!1,default:"auto"}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN",es:"es_MX",ja:"ja"}}},computed:{containerWidth:function(){var e=this.width;return/^[\d]+(\.[\d]+)?$/.test(e)?"".concat(e,"px"):e}},watch:{value:function(e){var t=this;!this.hasChange&&this.hasInit&&this.$nextTick((function(){return window.tinymce.get(t.tinymceId).setContent(e||"")}))}},mounted:function(){this.init()},activated:function(){window.tinymce&&this.initTinymce()},deactivated:function(){this.destroyTinymce()},destroyed:function(){this.destroyTinymce()},methods:{init:function(){var e=this;m(f,(function(t){t?e.$message.error(t.message):e.initTinymce()}))},initTinymce:function(){var e=this,t=this;window.tinymce.init({selector:"#".concat(this.tinymceId),language:this.languageTypeList["en"],height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:l,menubar:this.menubar,plugins:o,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:function(n){t.value&&n.setContent(t.value),t.hasInit=!0,n.on("NodeChange Change KeyUp SetContent",(function(){e.hasChange=!0,e.$emit("input",n.getContent())}))},setup:function(e){e.on("FullscreenStateChanged",(function(e){t.fullscreen=e.state}))},convert_urls:!1})},destroyTinymce:function(){var e=window.tinymce.get(this.tinymceId);this.fullscreen&&e.execCommand("mceFullScreen"),e&&e.destroy()},setContent:function(e){window.tinymce.get(this.tinymceId).setContent(e)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(e){var t=this;e.forEach((function(e){window.tinymce.get(t.tinymceId).insertContent('<img class="wscnph" src="'.concat(e.url,'" >'))}))}}},g=h,b=(n("b19f"),n("2877")),_=Object(b["a"])(g,i,r,!1,null,"3a4cd6c3",null);t["a"]=_.exports},b19f:function(e,t,n){"use strict";var i=n("f218"),r=n.n(i);r.a},e20e:function(e,t,n){},e70b:function(e,t,n){"use strict";var i=n("e20e"),r=n.n(i);r.a},f218:function(e,t,n){}}]);